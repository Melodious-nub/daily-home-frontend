<div class="otp-container d-flex flex-column justify-content-between">
  <!-- Back Icon -->
  <button mat-icon-button class="back-btn" (click)="goBackToSignup()">
    <mat-icon>arrow_back</mat-icon>
  </button>

  <!-- Content -->
  <div class="otp-content text-center">
    <h2 class="title">OTP Verification</h2>
    <p class="subtitle">
      Enter the verification code we just sent to your mail address <br />
      <strong>{{ email }}</strong>
    </p>

    <!-- OTP Inputs -->
    <div class="otp-inputs d-flex justify-content-center gap-2">
      <input 
        type="number" 
        maxlength="1" 
        class="otp-box" 
        [(ngModel)]="otpDigits[0]"
        (input)="onOtpInput(0, $event)"
        (keydown)="onOtpKeydown(0, $event)"
        [disabled]="isLoading"
      />
      <input 
        type="number" 
        maxlength="1" 
        class="otp-box" 
        [(ngModel)]="otpDigits[1]"
        (input)="onOtpInput(1, $event)"
        (keydown)="onOtpKeydown(1, $event)"
        [disabled]="isLoading"
      />
      <input 
        type="number" 
        maxlength="1" 
        class="otp-box" 
        [(ngModel)]="otpDigits[2]"
        (input)="onOtpInput(2, $event)"
        (keydown)="onOtpKeydown(2, $event)"
        [disabled]="isLoading"
      />
      <input 
        type="number" 
        maxlength="1" 
        class="otp-box" 
        [(ngModel)]="otpDigits[3]"
        (input)="onOtpInput(3, $event)"
        (keydown)="onOtpKeydown(3, $event)"
        [disabled]="isLoading"
      />
    </div>

    <!-- Success Message -->
    @if (successMessage) {
      <div class="success-message">
        {{ successMessage }}
      </div>
    }

    <!-- Error Message -->
    @if (errorMessage) {
      <div class="error-message">
        {{ errorMessage }}
      </div>
    }

    <!-- Resend & Timer -->
    <div class="resend-wrap d-flex justify-content-between mt-4 px-2">
      <span class="resend-text">
        Didn't receive code? 
        <a 
          class="resend-link" 
          href="#" 
          (click)="resendOtp(); $event.preventDefault()"
          [class.disabled]="!canResend || resendLoading"
        >
                      @if (!resendLoading) {
              <span>Resend</span>
            }
            @if (resendLoading) {
              <span>Sending...</span>
            }
          </a>
        </span>
        @if (!canResend) {
          <span class="timer">{{ formattedTime }}</span>
        }
    </div>
  </div>

  <!-- Verify Button -->
  <button 
    type="button"
    class="btn btn-primary"
    (click)="onSubmit()"
    [disabled]="isLoading || !isOtpComplete()"
  >
            @if (isLoading) {
          <i class="fa-solid fa-spinner fa-spin-pulse"></i>
        }
        @if (!isLoading) {
          <span>Verify</span>
        }
        @if (isLoading) {
          <span>Verifying...</span>
        }
  </button>
</div>
